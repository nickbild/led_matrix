typedef uint32_t PortType;

// Pointers to register addresses.
volatile PortType *addrPortA;
volatile PortType *addrPortB;

// Bit masks for pins.
PortType maskR1;
PortType maskG1;
PortType maskB1;

PortType maskR2;
PortType maskG2;
PortType maskB2;

PortType maskSelectA;
PortType maskSelectB;
PortType maskSelectC;
PortType maskSelectD;

PortType maskOE;
PortType maskLatch;
PortType maskClk;

// Pin numbers.
int pinR1 = 2;
int pinG1 = 3;
int pinB1 = 4;

int pinR2 = 5;
int pinG2 = 7; //6
int pinB2 = 9; //7

int pinOE = 10; //9
int latch = 11; //10
int pinClk = A4;

int selectA = A0;
int selectB = A1;
int selectC = A2;
int selectD = A3;

// Current state of matrix.
int currentRow = 0;
int frame = 1;  // A "frame" is defined here as one draw of all rows on the matix.
const int totalFrames = 35; // PWM pattern restarts after this many frames are drawn (higher == greater resolution == more colors; too high == flicker).

// Animation control.
int imgNum = 0;
int framesElapsed = 0;
const int changeImageFrames = 750;  // Set to -1 to display a single image.  Larger number == longer delay between image changes.
const int numImages = 4;  // >1 means animation.

// Data to display.
int brightnessR[numImages][32][32] = {
                              {
                                {7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,36,7,7,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,36,36,7,7,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,7,22,35,35,35,35,35,35,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,7,22,35,35,35,35,0,0,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,0,0,7,7,7,7,7,22,35,35,35,35,0,0,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,0,0,0,7,7,7,7,7,22,35,35,35,35,35,35,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,0,0,0,7,7,7,7,7,22,35,22,22,22,22,22,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,36,36,36,7,7,7,7,36,22,22,22,35,35,35,22,22,22,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,36,36,36,36,36,36,36,36,22,22,22,22,22,22,22,36,36,36,36,36,36,7,7,7,7,7,7},
                                {7,7,7,7,7,36,36,36,36,36,36,36,36,36,22,22,22,22,22,36,36,36,36,36,36,36,36,7,7,7,7,7},
                                {7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,22,22,22,36,36,36,36,36,36,36,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,22,36,36,36,36,36,36,36,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,35,35,0,0,0,0,0,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,0,35,0,0,0,0,0,7,7,0,0,0,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,35,35,0,0,0,0,0,7,7,0,0,0,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,7,0,0,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,7,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,36,36,36,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,36,36,36,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,0,0,7,0,0,0,7,7,7,7,7,0,0,0,7,0,0,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,0,0,0,0,0,0,7,7,7,7,7,0,0,0,0,0,0,7,7,7,7,7,7,7}
                              },
                              {
                                {7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,36,7,7,7,7,7,7,7,7,7,7,7,7,7},
                                {0,7,7,0,7,7,0,0,0,0,7,7,7,7,7,7,7,36,36,7,7,7,7,7,7,7,7,7,7,7,7,7},
                                {0,7,7,0,7,7,0,7,7,0,7,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7,7,7,7},
                                {0,7,7,0,7,7,0,7,7,0,7,7,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7,7,7,7},
                                {0,0,0,0,7,7,0,7,7,0,7,7,7,7,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7,7,7,7},
                                {0,7,7,0,7,7,0,7,7,0,7,7,7,36,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7,7,7,7},
                                {0,7,7,0,7,7,0,7,7,0,7,7,36,36,36,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7,7,7},
                                {0,7,7,0,7,7,0,0,0,0,7,7,22,35,35,35,35,35,35,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,7,22,35,0,0,35,0,0,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,0,0,7,7,7,22,35,0,0,35,0,0,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,0,0,0,7,7,7,22,35,35,35,35,35,35,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,0,0,0,7,7,7,22,35,22,22,22,22,22,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,36,36,36,7,7,36,22,22,22,35,35,35,22,22,22,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,36,36,36,36,36,36,36,36,22,22,22,22,22,22,22,36,36,36,36,36,36,7,7,7,7,7,7},
                                {7,7,7,7,7,36,36,36,36,36,36,36,36,36,22,22,22,22,22,36,36,36,36,36,36,36,36,7,7,7,7,7},
                                {7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,22,22,22,36,36,36,36,36,36,36,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,22,36,36,36,36,36,36,36,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,35,35,0,0,0,0,0,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,0,35,0,0,0,0,0,7,7,0,0,0,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,35,35,0,0,0,0,0,7,7,0,0,0,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,7,0,0,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,7,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,36,36,36,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,36,36,36,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,0,0,7,0,0,0,7,7,7,7,7,0,0,0,7,0,0,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,0,0,0,0,0,0,7,7,7,7,7,0,0,0,0,0,0,7,7,7,7,7,7,7}
                              },
                              {
                                {7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,36,7,7,7,7,7,7,7,7,7,7,7,7,7},
                                {0,7,7,0,7,7,0,0,0,0,7,7,7,7,7,7,7,36,36,7,7,7,1,7,7,1,7,7,1,1,1,1},
                                {0,7,7,0,7,7,0,7,7,0,7,7,7,7,7,7,36,36,36,7,7,7,1,7,7,1,7,7,1,7,7,1},
                                {0,7,7,0,7,7,0,7,7,0,7,7,7,7,7,36,36,36,36,36,7,7,1,7,7,1,7,7,1,7,7,1},
                                {0,0,0,0,7,7,0,7,7,0,7,7,7,7,36,36,36,36,36,36,7,7,1,1,1,1,7,7,1,7,7,1},
                                {0,7,7,0,7,7,0,7,7,0,7,7,7,36,36,36,36,36,36,36,7,7,1,7,7,1,7,7,1,7,7,1},
                                {0,7,7,0,7,7,0,7,7,0,7,7,36,36,36,36,36,36,36,36,36,7,1,7,7,1,7,7,1,7,7,1},
                                {0,7,7,0,7,7,0,0,0,0,7,7,22,35,35,35,35,35,35,35,22,7,1,7,7,1,7,7,1,1,1,1},
                                {7,7,7,7,7,7,7,7,7,7,7,7,22,35,0,0,35,0,0,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,0,0,7,7,7,7,7,7,22,35,0,0,35,0,0,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,0,0,0,7,7,7,7,7,7,22,35,35,35,35,35,35,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,0,0,0,7,7,7,7,7,7,22,35,22,22,22,22,22,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,36,36,36,7,7,7,7,7,36,22,22,22,35,35,35,22,22,22,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,36,36,36,36,36,36,36,36,22,22,22,22,22,22,22,36,36,36,36,36,36,7,7,7,7,7,7},
                                {7,7,7,7,7,36,36,36,36,36,36,36,36,36,22,22,22,22,22,36,36,36,36,36,36,36,36,7,7,7,7,7},
                                {7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,22,22,22,36,36,36,36,36,36,36,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,22,36,36,36,36,36,36,36,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,35,35,0,0,0,0,0,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,0,35,0,0,0,0,0,7,7,0,0,0,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,35,35,0,0,0,0,0,7,7,0,0,0,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,7,0,0,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,7,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,36,36,36,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,36,36,36,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,0,0,7,0,0,0,7,7,7,7,7,0,0,0,7,0,0,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,0,0,0,0,0,0,7,7,7,7,7,0,0,0,0,0,0,7,7,7,7,7,7,7}
                              },
                              {
                                {7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,36,7,7,7,7,7,7,7,7,7,7,7,7,7},
                                {0,7,7,0,7,7,0,0,0,0,7,7,7,7,7,7,7,36,36,7,7,7,1,7,7,1,7,7,1,1,1,1},
                                {0,7,7,0,7,7,0,7,7,0,7,7,7,7,7,7,36,36,36,7,7,7,1,7,7,1,7,7,1,7,7,1},
                                {0,7,7,0,7,7,0,7,7,0,7,7,7,7,7,36,36,36,36,36,7,7,1,7,7,1,7,7,1,7,7,1},
                                {0,0,0,0,7,7,0,7,7,0,7,7,7,7,36,36,36,36,36,36,7,7,1,1,1,1,7,7,1,7,7,1},
                                {0,7,7,0,7,7,0,7,7,0,7,7,7,36,36,36,36,36,36,36,7,7,1,7,7,1,7,7,1,7,7,1},
                                {0,7,7,0,7,7,0,7,7,0,7,7,36,36,36,36,36,36,36,36,36,7,1,7,7,1,7,7,1,7,7,1},
                                {0,7,7,0,7,7,0,0,0,0,7,7,22,35,35,35,35,35,35,35,22,7,1,7,7,1,7,7,1,1,1,1},
                                {7,7,7,7,7,7,7,7,7,7,7,7,22,35,0,0,35,0,0,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,0,0,7,7,7,7,22,35,0,0,35,0,0,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,0,0,0,7,7,7,7,22,35,35,35,35,35,35,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,0,0,0,7,7,7,7,22,35,22,22,22,22,22,35,22,7,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,36,36,36,7,7,7,36,22,22,22,35,35,35,22,22,22,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,36,36,36,36,36,36,36,36,22,22,22,22,22,22,22,36,36,36,36,36,36,7,7,7,7,7,7},
                                {7,7,7,7,7,36,36,36,36,36,36,36,36,36,22,22,22,22,22,36,36,36,36,36,36,36,36,7,7,7,7,7},
                                {7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,22,22,22,36,36,36,36,36,36,36,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,22,36,36,36,36,36,36,36,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,36,36,36,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,35,35,35,0,0,0,0,0,7,7,36,36,36,7,7,7,7},
                                {33,7,7,33,7,33,33,33,33,7,0,0,0,0,0,35,0,35,0,0,0,0,0,7,7,0,0,0,7,7,7,7},
                                {33,7,7,33,7,33,7,7,33,7,0,0,0,0,0,35,35,35,0,0,0,0,0,7,7,0,0,0,7,7,7,7},
                                {33,7,7,33,7,33,7,7,33,7,36,36,36,36,36,36,36,36,36,36,36,36,36,7,7,7,0,0,7,7,7,7},
                                {33,33,33,33,7,33,7,7,33,7,36,36,36,36,36,36,7,36,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {33,7,7,33,7,33,7,7,33,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {33,7,7,33,7,33,7,7,33,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {33,7,7,33,7,33,33,33,33,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,36,36,36,36,36,7,7,7,36,36,36,36,36,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,36,36,36,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,7,7,7,36,36,36,7,7,7,7,7,36,36,36,7,7,7,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,0,0,7,0,0,0,7,7,7,7,7,0,0,0,7,0,0,7,7,7,7,7,7,7},
                                {7,7,7,7,7,7,7,7,0,0,0,0,0,0,7,7,7,7,7,0,0,0,0,0,0,7,7,7,7,7,7,7}
                              }
                           };

int brightnessG[numImages][32][32] = { 
                              {
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,36,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,36,36,36,36,36,36,36,36,36,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,20,20,20,18,18,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,3,3,3,3,3,20,20,20,20,20,18,18,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,0,0,0,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,0,0,0,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,36,36,36,3,3,3,3,0,20,20,20,20,20,20,20,20,20,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,20,20,20,20,20,20,20,0,0,0,0,0,0,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,20,20,0,0,0,0,0,0,0,0,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,0,0,0,0,0,0,0,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,36,36,0,0,0,0,0,3,3,36,36,36,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,0,36,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,36,36,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,36,36,36,3,3,3,3,3,36,36,36,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,3,0,0,0,3,3,3,3,3,0,0,0,3,0,0,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3}
                              },
                              {
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,36,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,3,0,0,0,0,3,3,3,3,3,3,3,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,3,0,3,3,0,3,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,3,0,3,3,0,3,3,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {0,0,0,0,3,3,0,3,3,0,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,3,0,3,3,0,3,3,3,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,3,0,3,3,0,3,3,36,36,36,36,36,36,36,36,36,3,3,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,3,0,0,0,0,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,18,18,20,18,18,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,0,0,3,3,3,20,20,18,18,20,18,18,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,36,36,36,3,3,0,20,20,20,20,20,20,20,20,20,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,20,20,20,20,20,20,20,0,0,0,0,0,0,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,20,20,0,0,0,0,0,0,0,0,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,0,0,0,0,0,0,0,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,36,36,0,0,0,0,0,3,3,36,36,36,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,0,36,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,36,36,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,36,36,36,3,3,3,3,3,36,36,36,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,3,0,0,0,3,3,3,3,3,0,0,0,3,0,0,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3}
                              },
                              {
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,36,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,3,0,0,0,0,3,3,3,3,3,3,3,0,0,3,3,3,22,3,3,22,3,3,22,22,22,22},
                                {0,3,3,0,3,3,0,3,3,0,3,3,3,3,3,3,0,0,0,3,3,3,22,3,3,22,3,3,22,3,3,22},
                                {0,3,3,0,3,3,0,3,3,0,3,3,3,3,3,0,0,0,0,0,3,3,22,3,3,22,3,3,22,3,3,22},
                                {0,0,0,0,3,3,0,3,3,0,3,3,3,3,0,0,0,0,0,0,3,3,22,22,22,22,3,3,22,3,3,22},
                                {0,3,3,0,3,3,0,3,3,0,3,3,3,0,0,0,0,0,0,0,3,3,22,3,3,22,3,3,22,3,3,22},
                                {0,3,3,0,3,3,0,3,3,0,3,3,36,36,36,36,36,36,36,36,36,3,22,3,3,22,3,3,22,3,3,22},
                                {0,3,3,0,3,3,0,0,0,0,3,3,20,20,20,20,20,20,20,20,20,3,22,3,3,22,3,3,22,22,22,22},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,18,18,20,18,18,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,0,0,3,3,3,3,3,3,20,20,18,18,20,18,18,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,0,0,0,3,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,0,0,0,3,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,36,36,36,3,3,3,3,3,0,20,20,20,20,20,20,20,20,20,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,20,20,20,20,20,20,20,0,0,0,0,0,0,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,20,20,0,0,0,0,0,0,0,0,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,0,0,0,0,0,0,0,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,36,36,0,0,0,0,0,3,3,36,36,36,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,0,36,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,36,36,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,36,36,36,3,3,3,3,3,36,36,36,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,3,0,0,0,3,3,3,3,3,0,0,0,3,0,0,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3}
                              },
                              {
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,36,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,3,0,0,0,0,3,3,3,3,3,3,3,0,0,3,3,3,22,3,3,22,3,3,22,22,22,22},
                                {0,3,3,0,3,3,0,3,3,0,3,3,3,3,3,3,0,0,0,3,3,3,22,3,3,22,3,3,22,3,3,22},
                                {0,3,3,0,3,3,0,3,3,0,3,3,3,3,3,0,0,0,0,0,3,3,22,3,3,22,3,3,22,3,3,22},
                                {0,0,0,0,3,3,0,3,3,0,3,3,3,3,0,0,0,0,0,0,3,3,22,22,22,22,3,3,22,3,3,22},
                                {0,3,3,0,3,3,0,3,3,0,3,3,3,0,0,0,0,0,0,0,3,3,22,3,3,22,3,3,22,3,3,22},
                                {0,3,3,0,3,3,0,3,3,0,3,3,36,36,36,36,36,36,36,36,36,3,22,3,3,22,3,3,22,3,3,22},
                                {0,3,3,0,3,3,0,0,0,0,3,3,20,20,20,20,20,20,20,20,20,3,22,3,3,22,3,3,22,22,22,22},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,18,18,20,18,18,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,3,3,3,3,20,20,18,18,20,18,18,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,36,36,36,3,3,3,0,20,20,20,20,20,20,20,20,20,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,20,20,20,20,20,20,20,0,0,0,0,0,0,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,20,20,0,0,0,0,0,0,0,0,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,0,0,0,0,0,0,0,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,36,36,36,0,0,0,0,0,3,3,36,36,36,3,3,3,3},
                                {0,3,3,0,3,0,0,0,0,3,0,0,0,0,0,36,0,36,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {0,3,3,0,3,0,3,3,0,3,0,0,0,0,0,36,36,36,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {0,3,3,0,3,0,3,3,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,3},
                                {0,0,0,0,3,0,3,3,0,3,0,0,0,0,0,0,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,0,3,3,0,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,0,3,3,0,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {0,3,3,0,3,0,0,0,0,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,36,36,36,3,3,3,3,3,36,36,36,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,3,0,0,0,3,3,3,3,3,0,0,0,3,0,0,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3}
                              }
                           };

int brightnessB[numImages][32][32] = {
                              {
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,36,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,36,36,36,36,36,36,36,36,36,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,20,20,20,26,26,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,3,3,3,3,3,20,20,20,20,20,26,26,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,0,0,0,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,0,0,0,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,36,36,36,3,3,3,3,0,20,20,20,20,20,20,20,20,20,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,20,20,20,20,20,20,20,0,0,0,0,0,0,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,20,20,0,0,0,0,0,0,0,0,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,0,0,0,0,0,0,0,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,1,1,0,0,0,0,0,3,3,36,36,36,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,0,1,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,1,1,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,36,36,36,3,3,3,3,3,36,36,36,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,3,0,0,0,3,3,3,3,3,0,0,0,3,0,0,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3}
                              },
                              {
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,36,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {36,3,3,36,3,3,36,36,36,36,3,3,3,3,3,3,3,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {36,3,3,36,3,3,36,3,3,36,3,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {36,3,3,36,3,3,36,3,3,36,3,3,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {36,36,36,36,3,3,36,3,3,36,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {36,3,3,36,3,3,36,3,3,36,3,3,3,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3},
                                {36,3,3,36,3,3,36,3,3,36,3,3,36,36,36,36,36,36,36,36,36,3,3,3,3,3,3,3,3,3,3,3},
                                {36,3,3,36,3,3,36,36,36,36,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,26,26,20,26,26,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,0,0,3,3,3,20,20,26,26,20,26,26,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,36,36,36,3,3,0,20,20,20,20,20,20,20,20,20,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,20,20,20,20,20,20,20,0,0,0,0,0,0,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,20,20,0,0,0,0,0,0,0,0,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,0,0,0,0,0,0,0,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,1,1,0,0,0,0,0,3,3,36,36,36,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,0,1,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,1,1,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,36,36,36,3,3,3,3,3,36,36,36,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,3,0,0,0,3,3,3,3,3,0,0,0,3,0,0,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3}
                              },
                              {
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,36,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {36,3,3,36,3,3,36,36,36,36,3,3,3,3,3,3,3,0,0,3,3,3,0,3,3,0,3,3,0,0,0,0},
                                {36,3,3,36,3,3,36,3,3,36,3,3,3,3,3,3,0,0,0,3,3,3,0,3,3,0,3,3,0,3,3,0},
                                {36,3,3,36,3,3,36,3,3,36,3,3,3,3,3,0,0,0,0,0,3,3,0,3,3,0,3,3,0,3,3,0},
                                {36,36,36,36,3,3,36,3,3,36,3,3,3,3,0,0,0,0,0,0,3,3,0,0,0,0,3,3,0,3,3,0},
                                {36,3,3,36,3,3,36,3,3,36,3,3,3,0,0,0,0,0,0,0,3,3,0,3,3,0,3,3,0,3,3,0},
                                {36,3,3,36,3,3,36,3,3,36,3,3,36,36,36,36,36,36,36,36,36,3,0,3,3,0,3,3,0,3,3,0},
                                {36,3,3,36,3,3,36,36,36,36,3,3,20,20,20,20,20,20,20,20,20,3,0,3,3,0,3,3,0,0,0,0},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,26,26,20,26,26,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,0,0,3,3,3,3,3,3,20,20,26,26,20,26,26,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,0,0,0,3,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,0,0,0,3,3,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,36,36,36,3,3,3,3,3,0,20,20,20,20,20,20,20,20,20,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,20,20,20,20,20,20,20,0,0,0,0,0,0,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,20,20,0,0,0,0,0,0,0,0,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,0,0,0,0,0,0,0,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,1,1,0,0,0,0,0,3,3,36,36,36,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,0,1,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,1,1,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,36,36,36,3,3,3,3,3,36,36,36,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,3,0,0,0,3,3,3,3,3,0,0,0,3,0,0,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3}
                              },
                              {
                                {3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,36,3,3,3,3,3,3,3,3,3,3,3,3,3},
                                {36,3,3,36,3,3,36,36,36,36,3,3,3,3,3,3,3,0,0,3,3,3,0,3,3,0,3,3,0,0,0,0},
                                {36,3,3,36,3,3,36,3,3,36,3,3,3,3,3,3,0,0,0,3,3,3,0,3,3,0,3,3,0,3,3,0},
                                {36,3,3,36,3,3,36,3,3,36,3,3,3,3,3,0,0,0,0,0,3,3,0,3,3,0,3,3,0,3,3,0},
                                {36,36,36,36,3,3,36,3,3,36,3,3,3,3,0,0,0,0,0,0,3,3,0,0,0,0,3,3,0,3,3,0},
                                {36,3,3,36,3,3,36,3,3,36,3,3,3,0,0,0,0,0,0,0,3,3,0,3,3,0,3,3,0,3,3,0},
                                {36,3,3,36,3,3,36,3,3,36,3,3,36,36,36,36,36,36,36,36,36,3,0,3,3,0,3,3,0,3,3,0},
                                {36,3,3,36,3,3,36,36,36,36,3,3,20,20,20,20,20,20,20,20,20,3,0,3,3,0,3,3,0,0,0,0},
                                {3,3,3,3,3,3,3,3,3,3,3,3,20,20,26,26,20,26,26,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,3,3,3,3,20,20,26,26,20,26,26,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,3,3,3,3,20,20,20,20,20,20,20,20,20,3,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,36,36,36,3,3,3,0,20,20,20,20,20,20,20,20,20,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,20,20,20,20,20,20,20,0,0,0,0,0,0,3,3,3,3,3,3},
                                {3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,20,20,0,0,0,0,0,0,0,0,3,3,3,3,3},
                                {3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,20,20,20,0,0,0,0,0,0,0,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,1,1,0,0,0,0,0,3,3,36,36,36,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,0,1,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,1,1,1,0,0,0,0,0,3,3,0,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,0,0,0,3,3,3,3,3,0,0,0,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,3,3,3,36,36,36,3,3,3,3,3,36,36,36,3,3,3,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,3,0,0,0,3,3,3,3,3,0,0,0,3,0,0,3,3,3,3,3,3,3},
                                {3,3,3,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,3,3,3,3,3,3,3}
                              }
                           };

void setup() {
  addrPortA = portOutputRegister(digitalPinToPort(pinR1));
  addrPortB = portOutputRegister(digitalPinToPort(pinG1));
  
  maskR1 = digitalPinToBitMask(pinR1);
  maskG1 = digitalPinToBitMask(pinG1);
  maskB1 = digitalPinToBitMask(pinB1);

  maskR2 = digitalPinToBitMask(pinR2);
  maskG2 = digitalPinToBitMask(pinG2);
  maskB2 = digitalPinToBitMask(pinB2);

  maskSelectA = digitalPinToBitMask(selectA);
  maskSelectB = digitalPinToBitMask(selectB);
  maskSelectC = digitalPinToBitMask(selectC);
  maskSelectD = digitalPinToBitMask(selectD);

  maskOE = digitalPinToBitMask(pinOE);
  maskLatch = digitalPinToBitMask(latch);
  maskClk = digitalPinToBitMask(pinClk);

  pinMode(pinR1, OUTPUT);
  pinMode(pinG1, OUTPUT);
  pinMode(pinB1, OUTPUT);

  pinMode(pinR2, OUTPUT);
  pinMode(pinG2, OUTPUT);
  pinMode(pinB2, OUTPUT);

  pinMode(pinOE, OUTPUT);
  pinMode(latch, OUTPUT);
  pinMode(pinClk, OUTPUT);

  pinMode(selectA, OUTPUT);
  pinMode(selectB, OUTPUT);
  pinMode(selectC, OUTPUT);
  pinMode(selectD, OUTPUT);
}

void loop() {
  // Send on/off bits for each LED (32 columns, R/G/B LED per column), and for top and bottom rows.
  for (int i=0; i<32; i++){
    // Upper rows.
    if (frame <= brightnessR[imgNum][currentRow][i]) {
      *addrPortA |= maskR1;
    } else {
      *addrPortA &= ~maskR1;
    }
    
    if (frame <= brightnessG[imgNum][currentRow][i]) {
      *addrPortB |= maskG1;
    } else {
      *addrPortB &= ~maskG1;
    }
    
    if (frame <= brightnessB[imgNum][currentRow][i]) {
      *addrPortA |= maskB1;
    } else {
      *addrPortA &= ~maskB1;
    }

    // Lower rows.
    if (frame <= brightnessR[imgNum][currentRow+16][i]) {
      *addrPortA |= maskR2;
    } else {
      *addrPortA &= ~maskR2;
    }
    
    if (frame <= brightnessG[imgNum][currentRow+16][i]) {
      *addrPortA |= maskG2;
    } else {
      *addrPortA &= ~maskG2;
    }
    
    if (frame <= brightnessB[imgNum][currentRow+16][i]) {
      *addrPortA |= maskB2;
    } else {
      *addrPortA &= ~maskB2;
    }

    // Hit clock to indicate pixel values are set.
    *addrPortA |= maskClk;
    *addrPortA &= ~maskClk;
  }

  // Turn off LEDs before turning on current row.
  *addrPortA |= maskOE;
  *addrPortA &= ~maskOE;

  // Set current row.
  if (bitRead(currentRow, 0) == 1) {
    *addrPortA |= maskSelectA;
  } else {
    *addrPortA &= ~maskSelectA;
  }

  if (bitRead(currentRow, 1) == 1) {
    *addrPortA |= maskSelectB;
  } else {
    *addrPortA &= ~maskSelectB;
  }

  if (bitRead(currentRow, 2) == 1) {
    *addrPortB |= maskSelectC;
  } else {
    *addrPortB &= ~maskSelectC;
  }

  if (bitRead(currentRow, 3) == 1) {
    *addrPortB |= maskSelectD;
  } else {
    *addrPortB &= ~maskSelectD;
  }

  // All data is in.  Latch current row.
  *addrPortA |= maskLatch;
  *addrPortA &= ~maskLatch;

  // Move to next row.
  currentRow++;
  if (currentRow == 16) {
    currentRow = 0;
    
    frame++;
    if (frame > totalFrames) {
      frame = 1;
    }

    framesElapsed++;
  }

  // Control image change speed.
  if (framesElapsed >= changeImageFrames) {
    framesElapsed = 0;

    imgNum++;
    if (imgNum == numImages) {
      imgNum = 0;
    }
  }
}

